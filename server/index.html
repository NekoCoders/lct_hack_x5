<!DOCTYPE html>
    <html>
    <head>
        <title>NER Prediction API Test</title>
        <style>
            body { font-family: Arial, sans-serif; margin: 40px; }
            .container { max-width: 800px; margin: 0 auto; }
            textarea { width: 100%; height: 100px; margin: 10px 0; padding: 10px; }
            button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
            button:hover { background: #0056b3; }
            .result { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; }
            .entity { display: inline-block; margin: 2px; padding: 2px 5px; border-radius: 3px; }
            .B-TYPE { background: #ffcccc; }
            .I-TYPE { background: #ffdddd; }
            .B-BRAND { background: #ccccff; }
            .I-BRAND { background: #ddddff; }
            .B-VOLUME { background: #ccffcc; }
            .I-VOLUME { background: #ddffdd; }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>üß† NER Prediction API Test</h1>
            <p>–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π:</p>
            
            <textarea id="textInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–¥–µ—Å—å...">–Ø –∫—É–ø–∏–ª —Å–≤–µ–∂–µ–µ –º–æ–ª–æ–∫–æ –ü—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∏–Ω–æ –∏ –ø–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –º–∞—Å–ª–æ –ß—É–¥–æ.</textarea>
            
            <button onclick="predictEntities()">üîç –†–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏</button>
            
            <div id="result" class="result" style="display:none;">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
                <div id="highlightedText"></div>
                <pre id="jsonResult"></pre>
            </div>

            <div style="margin-top: 30px;">
                <h3>–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h3>
                <button onclick="loadExample(1)">–ü—Ä–∏–º–µ—Ä 1</button>
                <button onclick="loadExample(2)">–ü—Ä–∏–º–µ—Ä 2</button>
                <button onclick="loadExample(3)">–ü—Ä–∏–º–µ—Ä 3</button>
            </div>

            <script>
                const examples = {
                    1: "–Ø –∫—É–ø–∏–ª —Å–≤–µ–∂–µ–µ –º–æ–ª–æ–∫–æ –ü—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∏–Ω–æ –∏ —Å–≥—É—â–µ–Ω–Ω–æ–µ –º–∞—Å–ª–æ.",
                    2: "–í –º–∞–≥–∞–∑–∏–Ω–µ –±—ã–ª–æ –ø–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –º—è—Å–æ –æ—Ç –î–æ–º–∏–∫ –≤ –¥–µ—Ä–µ–≤–Ω–µ –∏ —á—É–¥–æ –º–æ–ª–æ–∫–æ.",
                    3: "–°–≥—É—â–µ–Ω–Ω–æ–µ –º–æ–ª–æ–∫–æ –∏ —Å–≤–µ–∂–µ–µ –º—è—Å–æ - –ª—É—á—à–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã."
                };

                function loadExample(num) {
                    document.getElementById('textInput').value = examples[num];
                }

                async function predictEntities() {
                    const text = document.getElementById('textInput').value;
                    const resultDiv = document.getElementById('result');
                    const highlightedDiv = document.getElementById('highlightedText');
                    const jsonPre = document.getElementById('jsonResult');

                    try {
                        const response = await fetch('/api/predict', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ input: text })
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const data = await response.json();
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º JSON —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                        jsonPre.textContent = JSON.stringify(data, null, 2);
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å—É—â–Ω–æ—Å—Ç–µ–π
                        let highlightedText = text;
                        const entities = data.sort((a, b) => b.start_index - a.start_index);
                        
                        entities.forEach(entity => {
                            const entityText = text.substring(entity.start_index, entity.end_index);
                            const highlighted = `<span class="entity ${entity.entity}" title="${entity.entity}">${entityText}</span>`;
                            highlightedText = highlightedText.substring(0, entity.start_index) + 
                                            highlighted + 
                                            highlightedText.substring(entity.end_index);
                        });
                        
                        highlightedDiv.innerHTML = '<strong>–¢–µ–∫—Å—Ç —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏:</strong><br>' + highlightedText;
                        resultDiv.style.display = 'block';

                    } catch (error) {
                        jsonPre.textContent = '–û—à–∏–±–∫–∞: ' + error.message;
                        resultDiv.style.display = 'block';
                    }
                }

                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                window.onload = function() {
                    predictEntities();
                };
            </script>
        </div>
    </body>
</html>